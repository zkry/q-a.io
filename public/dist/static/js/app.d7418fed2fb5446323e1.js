webpackJsonp([1],{NHnr:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=o("7+uW"),n={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var a=o("VU/8")({name:"App"},n,!1,function(e){o("U/cX")},null,null).exports,i=o("/ocq"),r=o("fZjL"),c=o.n(r),u=o("mtWM"),l=o.n(u),m={name:"Home",data:function(){return{errorMsg:"",errorActive:!1,roomName:"",roomCreated:!1,userID:"",questions:{},roomClosed:!1,sortMode:"NORMAL"}},computed:{noQuestions:function(){return console.log(this),0===c()(this.questions).length},getQuestionKeys:function(){var e=this,t=c()(this.questions);return"NORMAL"===this.sortMode?t:"SORTED"===this.sortMode?(t.sort(function(t,o){return e.questions[t].vote<e.questions[o].vote}),t):"SORTED_REVERSE"===this.sortMode?(t.sort(function(t,o){return e.questions[t].vote>e.questions[o].vote}),t):t}},created:function(){var e=this,t=localStorage.getItem("userID"),o=localStorage.getItem("roomName");t&&o&&(this.userID=localStorage.getItem("userID"),this.roomName=localStorage.getItem("roomName"),console.log("Reading ID from local storage:",this.userID),console.log("Reading room name from local storage:",o),this.roomCreated=!0,this.errorActive=!1,this.getQuestions(),setInterval(function(){e.getQuestions()},2e3))},methods:{toggleSort:function(){"NORMAL"===this.sortMode?this.sortMode="SORTED":this.sortMode="NORMAL"},leaveRoom:function(){localStorage.removeItem("userID"),localStorage.removeItem("roomName"),location.reload()},closeRoom:function(){var e=this,t={uID:this.userID};l()({method:"post",url:"/api/v1/closeRoom/"+this.roomName,data:t,params:t,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(t){e.roomClosed=!0,console.log("Room closed")}).catch(function(e){console.log(e)})},hideError:function(){this.errorActive=!1},showError:function(e){this.errorMsg=e,this.errorActive=!0},getQuestions:function(){var e=this;l()({method:"get",url:"/api/v1/getQuestions/"+this.roomName,headers:{"Content-type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(t){for(var o=0;o<t.data.questions.length;o++){var s=t.data.questions[o].id;e.questions.hasOwnProperty(s)||e.$set(e.questions,s,{q:t.data.questions[o].q,vote:t.data.questions[o].vote,id:s})}t.data.is_closed&&(e.roomClosed=!0)})},onSubmit:function(){var e=this,t={roomName:this.roomName};l()({method:"post",url:"/api/v1/createRoom",data:t,params:t,headers:{"Content-type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(t){e.userID=t.data.uID,localStorage.setItem("userID",e.userID),localStorage.setItem("roomName",e.roomName),e.roomCreated=!0,e.errorActive=!1,e.getQuestions(),setInterval(function(){e.getQuestions()},2e3)}).catch(function(t){console.log(t.response.data),"Bad room name"===t.response.data.status&&e.showError("Invalid name for room. Valid characters are a thorugh z, _ and -. Room names are case insensitive")})}}},v={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"container"},[o("h1",[e._v("Unnamed Project")]),e._v(" "),o("transition",{attrs:{name:"fadefast"}},[o("div",{directives:[{name:"show",rawName:"v-show",value:e.errorActive,expression:"errorActive"}],staticClass:"error-msg"},[o("a",{staticClass:"cancel",on:{click:e.hideError}},[e._v("×")]),e._v(" "+e._s(e.errorMsg)+"\n    ")])]),e._v(" "),e.roomCreated?o("div",{staticClass:"extra-options",on:{click:e.closeRoom}},[o("ul",[o("li",{class:{"disabled-text":e.roomClosed},on:{click:e.closeRoom}},[e._v("Close the room")]),e._v(" "),o("li",{on:{click:e.leaveRoom}},[e._v("Leave the room")])])]):e._e(),e._v(" "),o("transition",{attrs:{name:"fade",mode:"out-in"}},[e.roomCreated?o("div",{key:"roomInfo"},[o("h1",{staticStyle:{"z-index":"10"}},[e._v(e._s(e.roomName)),e.roomClosed?o("span",{staticClass:"info-text"},[e._v(" closed")]):e._e()]),e._v(" "),o("h4",[e._v("Questions:")]),e._v(" "),e.noQuestions?e._e():o("div",{staticClass:"sort-btn",class:{"active-text":"SORTED"===e.sortMode},on:{click:e.toggleSort}},[e._v("Sort")]),e._v(" "),o("ul",{staticClass:"question-container"},e._l(e.getQuestionKeys,function(t){return o("li",{key:t,staticClass:"question-item",class:{"closed-question":e.closedRoom}},[o("span",{staticClass:"vote-arrow",class:["1"===e.questions[t].myVote?"active-vote":""],on:{click:function(o){e.vote(e.questions[t].id,"1")}}},[e._v("▲")]),e._v(" "),o("span",{staticClass:"vote-ct"},[e._v(e._s(e.questions[t].vote))]),e._v(" "),o("span",{staticClass:"vote-arrow",class:["-1"===e.questions[t].myVote?"active-vote":""],on:{click:function(o){e.vote(e.questions[t].id,"-1")}}},[e._v("▼")]),e._v("\n           "+e._s(e.questions[t].q)+"\n        ")])})),e._v(" "),e.noQuestions?o("p",{staticClass:"help-text"},[e._v("Have your listeners go to http://wtte.io/"+e._s(e.roomName)+" to submit their questions and have them be voted on")]):e._e()]):o("div",{key:"roomSelect",staticClass:"input"},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.roomName,expression:"roomName"}],attrs:{type:"text",placeholder:"Enter room name"},domProps:{value:e.roomName},on:{input:function(t){t.target.composing||(e.roomName=t.target.value)}}}),e._v(" "),o("a",{staticClass:"go-btn",on:{click:e.onSubmit}},[e._v("Go")])])])],1)},staticRenderFns:[]};var d=o("VU/8")(m,v,!1,function(e){o("a6pF")},"data-v-126020e3",null).exports,h=o("mvHQ"),p=o.n(h),g={name:"Observer",data:function(){return{errorMsg:"",errorActive:!1,roomName:"",validRoom:!0,closedRoom:!1,questions:{},askingQuestion:"",sortMode:"NORMAL"}},computed:{getQuestionKeys:function(){var e=this,t=c()(this.questions);return"NORMAL"===this.sortMode?t:"SORTED"===this.sortMode?(t.sort(function(t,o){return e.questions[t].vote<e.questions[o].vote}),t):"SORTED_REVERSE"===this.sortMode?(t.sort(function(t,o){return e.questions[t].vote>e.questions[o].vote}),t):t}},created:function(){var e=this;this.roomName=this.$route.params.roomName;var t=localStorage.getItem(this.roomName+":userID"),o={uID:t};l()({method:"post",url:"/api/v1/register/"+this.roomName,data:o,params:o,headers:{"Content-type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(o){e.userID=o.data.id,t===o.data.id&&e.loadVotes(),console.log("Registered with id ",e.userID),localStorage.setItem(e.roomName+":userID",e.userID),e.getQuestions(),setInterval(function(){e.getQuestions()},2e3)}).catch(function(t){console.log(t),t.response&&"Room does not exist"===t.response.data.status&&(e.roomName="Room "+e.roomName+" does not exist",e.validRoom=!1)})},methods:{sendQuestion:function(){var e=this;if(console.log("Sending Message"),this.askingQuestion.length<=5)this.showError("Message is too short to be valid.");else{var t={uID:this.userID,question:this.askingQuestion};l()({method:"post",url:"/api/v1/publishQuestion/"+this.roomName,data:t,params:t,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(t){console.log("Question added"),e.askingQuestion="",e.getQuestions()}).catch(function(t){e.showError(t.response.data.status)})}},vote:function(e,t){var o=this,s=t;this.questions[e].myVote===t&&(s="0");var n={qID:e,val:s,uID:this.userID};l()({method:"post",url:"/api/v1/vote/"+this.roomName,data:n,params:n,headers:{"Content-type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(t){o.questions[e].myVote=s,o.saveVotes(),o.$forceUpdate(),o.getQuestions()}).catch(function(e){console.log(e.response.data)})},saveVotes:function(){console.log("DEBUG: saving votes");var e={};for(var t in this.questions)"-1"!==this.questions[t].myVote&&"1"!==this.questions[t].myVote||(e[t]=this.questions[t].myVote);localStorage.setItem(this.roomName+":votes",p()(e))},loadVotes:function(){var e=this;this.getQuestions().then(function(){if(console.log("DEBUG: loading votes"),null!==localStorage.getItem(e.roomName+":votes")){var t=JSON.parse(localStorage.getItem(e.roomName+":votes"));for(var o in t)e.questions[o].myVote=t[o]}})},hideError:function(){this.errorActive=!1},showError:function(e){this.errorMsg=e,this.errorActive=!0},getQuestions:function(){var e=this;return l()({method:"get",url:"/api/v1/getQuestions/"+this.roomName,headers:{"Content-type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(t){for(var o=0;o<t.data.questions.length;o++){var s=t.data.questions[o].id;e.questions.hasOwnProperty(s)?e.questions[s].vote!==t.data.questions[o].vote&&e.$set(e.questions,s,{q:t.data.questions[o].q,vote:t.data.questions[o].vote,id:s,myVote:e.questions[s].myVote}):e.$set(e.questions,s,{q:t.data.questions[o].q,vote:t.data.questions[o].vote,id:s,myVote:"0"})}e.closedRoom=t.data.is_closed})}}},f={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"container"},[o("h1",[e._v("Unnamed Project")]),e._v(" "),o("transition",{attrs:{name:"fadefast"}},[o("div",{directives:[{name:"show",rawName:"v-show",value:e.errorActive,expression:"errorActive"}],staticClass:"error-msg"},[o("a",{staticClass:"cancel",on:{click:e.hideError}},[e._v("×")]),e._v(" "+e._s(e.errorMsg)+"\n    ")])]),e._v(" "),o("h2",[e._v(e._s(e.roomName)),e.closedRoom?o("span",{staticClass:"info-text"},[e._v(" closed")]):e._e()]),e._v(" "),e.validRoom?[o("h4",[e._v("Questions:")]),e._v(" "),o("div",{staticClass:"question-box-container"},[e._v("\n      Ask a question:\n       "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.askingQuestion,expression:"askingQuestion"}],staticClass:"question-box",attrs:{type:"text",disabled:e.closedRoom},domProps:{value:e.askingQuestion},on:{input:function(t){t.target.composing||(e.askingQuestion=t.target.value)}}}),e._v(" "),o("span",{staticClass:"envelope",on:{click:e.sendQuestion}},[e._v(" ✉")])]),e._v(" "),o("ul",{staticClass:"question-container"},e._l(e.getQuestionKeys,function(t){return o("li",{key:t,staticClass:"question-item",class:{"closed-question":e.closedRoom}},[o("span",{staticClass:"vote-arrow",class:["1"===e.questions[t].myVote?"active-vote":""],on:{click:function(o){e.vote(e.questions[t].id,"1")}}},[e._v("▲")]),e._v(" "),o("span",{staticClass:"vote-ct"},[e._v(e._s(e.questions[t].vote))]),e._v(" "),o("span",{staticClass:"vote-arrow",class:["-1"===e.questions[t].myVote?"active-vote":""],on:{click:function(o){e.vote(e.questions[t].id,"-1")}}},[e._v("▼")]),e._v("\n         "+e._s(e.questions[t].q)+"\n      ")])}))]:e._e()],2)},staticRenderFns:[]};var _=o("VU/8")(g,f,!1,function(e){o("Omd2")},"data-v-bd17e03e",null).exports;s.a.use(i.a);var q=new i.a({mode:"history",routes:[{path:"/",name:"Home",component:d},{path:"/:roomName",name:"Observer",component:_}]});s.a.config.productionTip=!1,new s.a({el:"#app",router:q,components:{App:a},template:"<App/>"})},Omd2:function(e,t){},"U/cX":function(e,t){},a6pF:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.d7418fed2fb5446323e1.js.map